class TFJError extends Error{constructor(t){super(t),this.name="TFJError"}}class TFJ{constructor(){this.json=[],this.version="1.1"}async init(t,e){console.log("TFJ init");try{e?await this.loadJSONWithCaching(t):await this.loadJSON(t)}catch(n){console.error("Error initializing TFJ:",n)}}async loadJSON(t){try{let e=await fetch(t);if(!e.ok)throw Error(`Error loading JSON: ${e.status} ${e.statusText}`);this.json=await e.json();let n=new CustomEvent("JSONLoaded",{detail:{json:this.json}});document.dispatchEvent(n),this.load()}catch(o){console.error("Error loading JSON:",o)}}async loadJSONWithCaching(t){let e=localStorage.getItem("TFJ_JSON");if(e)this.json=JSON.parse(e),this.load();else try{let n=await fetch(t);if(!n.ok)throw Error(`Error loading JSON: ${n.status} ${n.statusText}`);this.json=await n.json(),localStorage.setItem("TFJ_JSON",JSON.stringify(this.json)),this.load()}catch(o){console.error("Error loading JSON:",o)}}getJSON(){return this.json}load(){let t=this.getJSON().find(t=>!0===t.default);if(!t)throw new TFJError("Default language not found");let e=t.data;for(let n in e){let o=e[n];if("object"==typeof o&&o.content){let a=o.selector,r=o.type,l=document.querySelectorAll(a);l.length>0&&l.forEach(t=>{if("text"===r&&(t.textContent=o.content),"select"===r){let e=o.content;for(let n=0;n<e.length;n++)t.options[n].text=e[n]}else"value"===r?t.value=o.content:"placeholder"===r?t.placeholder=o.content:"title"===r?t.title=o.content:"alt"===r?t.alt=o.content:"href"===r?t.href=o.content:"src"===r?t.src=o.content:"disabled"===r&&(t.disabled=o.content)})}}let i=new CustomEvent("languageLoaded",{detail:{language:t.code}});document.dispatchEvent(i)}setLang(t){let e=this.getJSON().find(e=>e.code===t);if(!e)throw new TFJError("Language not found");this.updateContent(e.data);let n=new CustomEvent("languageChanged",{detail:{language:t}});document.dispatchEvent(n)}updateContent(t){for(let e in t){let n=t[e];if("object"==typeof n&&n.content){let o=n.selector,a=n.type,r=document.querySelectorAll(o);r.length>0&&r.forEach(t=>{if("text"===a&&(t.textContent=n.content),"select"===a){let e=n.content;for(let o=0;o<e.length;o++)t.options[o].text=e[o]}else"value"===a?t.value=n.content:"placeholder"===a?t.placeholder=n.content:"title"===a?t.title=n.content:"alt"===a?t.alt=n.content:"href"===a?t.href=n.content:"src"===a?t.src=n.content:"disabled"===a&&(t.disabled=n.content)})}}}getVersion(){return this.version}getLang(){let t=this.getJSON().find(t=>!0===t.default);if(!t)throw new TFJError("Default language not found");return t.code}getLangs(){let t=this.getJSON(),e=[];return t.forEach(t=>{e.push(t.code)}),e}getLangName(t){let e=this.getJSON().find(e=>e.code===t);if(!e)throw new TFJError("Language not found");return e.lang}getLangNames(){let t=this.getJSON(),e=[];return t.forEach(t=>{e.push(t.lang)}),e}}
